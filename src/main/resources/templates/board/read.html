<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/index :: setContent(~{this::content})}">
  <th:block th:fragment="content">
    <h1>Guestbook Read Page</h1>

    <div class="form-group">
      <label for="bno">bno</label>
      <input type="text" class="form-control" name="bno" placeholder="bno" id="bno" th:value="${dto.bno}" readonly="readonly">
    </div>
    <div class="form-group">
      <label for="title">Title</label>
      <input type="text" class="form-control" name="title" placeholder="title" id="title" th:value="${dto.title}" readonly="readonly">
    </div>
    <div class="form-group">
      <label>Content</label>
      <textarea class="form-control" name="content" placeholder="Content"  readonly="readonly">[[${dto.content}]]</textarea>
    </div>
    <div class="form-group">
      <label>Writer</label>
      <input type="text" class="form-control" name="writerName" placeholder="Writer" th:value="${dto.writerName}" readonly="readonly">
    </div>
    <div class="form-group">
      <label>regDate</label>
      <input type="text" class="form-control" name="regDate" placeholder="regDate" th:value="${#temporals.format(dto.regDate, 'yyyy-MM-dd')}" readonly="readonly">
<!--      th:value="${#temporals.format(dto.regDate,'yyyy/MM/dd')-->
    </div>
    <a class="btn btn-primary mt-3"
       th:href="@{/board/modify(page = ${requestDto.page}, size = ${requestDto.size}, bno = ${dto.bno}, type=${requestDto.type}, keyword=${requestDto.keyword})}">modify</a>
    <a th:href="@{/board/list(page = ${requestDto.page}, size = ${requestDto.size}, type=${requestDto.type}, keyword=${requestDto.keyword})}" class="btn btn-primary mt-3">List</a>

  </th:block>
</th:block>
<script>
  //전역으로 counter 0
  // 10 ** 3
  let counter = 0;
  function callLocal(n, cb){
    const add = 10 ** n;
    counter += add;
    console.log(`[local] 10^${n} = ${add} -> counter : ${counter}`);
    if(cb) cb();
  }
  function callAsync(n, cb){
    const add = 10 ** n;
    const delay =Math.floor(Math.random() * 1000); // 0~ 999

    setTimeout(() => {
      counter += add;
      console.log(`[async] 10^${n} = ${add} -> counter : ${counter}, delay: ${delay}ms`);
      if(cb) cb();
    }, delay);
  }
  //내가 원하는 순서대로 작동하지않음
  callAsync(0, () =>{
    callAsync(1, ()=>{
      callAsync(2, () => {
        callAsync(3, () => {
          callAsync(4, () => {
            callLocal(5,() =>{
              callLocal(6,() => {
                callLocal(7,() =>{
                  callLocal(8,() => {
                    callLocal(9,() => {
                      console.log("마지막 호출");
                    });
                  });
                })
              });
            });
          })
        });
      });
    });
  });

  // (() =>{callAsync(0); }) (); // 즉시실행 함수 형태
  // callAsync(1);
  // callAsync(2);
  // callAsync(3);
  // callAsync(4);
  // callLocal(5);
  // callLocal(6);
  // callLocal(7);
  // callLocal(8);
  // callLocal(9);
  //------------------
  // $.ajax({
  //   success: (data) => {
  //     $.ajax({
  //       success:(data) =>{
  //
  //       }
  //     })
  //   }
  // })
//------------------------- jquery스타일의 체이닝 이것도 dsl 방식.
//   $.ajax({
//     success: (data) =>{},
//     error: (data) =>{},
//     finally: (data) =>{}
//   })
//   .done((data) => {
//
//   })
//       .fail(error =>{
//
//       })
//       .always(()=>{
//
//       })
//   .done((data) => {
//
//   })

  // -------
</script>
</html>